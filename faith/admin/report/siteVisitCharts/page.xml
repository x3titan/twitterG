<page>
  <controls count="46">
    <control type="DivRoot" pathname="/divRoot">
      <backgroundColor>ffffff</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <height>785</height>
      <left>0</left>
      <onControlLoad><![CDATA[g5.p1 = ee.getControl("panel38");

//分页处理
g5.pageSize = 18;
g5.pageCurrent = 1;
g5.pageCount = 1;
g5.pageJump = function (pageNumber) {
    if (pageNumber < 1) pageNumber = 1;
    if (pageNumber > g5.pageCount) {
        pageNumber = g5.pageCount;
    }
    if (g5.pageCurrent != pageNumber) {
        g5.pageCurrent = pageNumber;
        if (g5.pageCurrent > 0) {
            query();
        }
    }
}

query();
       
]]></onControlLoad>
      <pageHead><![CDATA[<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<style>
.buttonBlue {
    background-color:#30b5ef;
    transition: background-color 1.0s;
}
.buttonBlue:hover{
    background-color:#289ccf;
    transition: background-color 0.3s;
}
   
.buttonSelectBlue {
    background-color: ;
    transition: background-color 0.3s;
}
.buttonSelectBlue:hover{
    background-color:#e0e0ff;
    transition: background-color 0.6s;
}


.buttonGray {
    background-color: ;
    transition: background-color 0.6s;
}
.buttonGray:hover{
    background-color:#f0f0ff;
    transition: background-color 0.3s;
}

</style>

<style>
.css_button1 {
    display:inline-block;
    padding:0.1em 0.5em 0.2em 0.5em;
    margin:0em 0.0em -0.3em 0.0em;
    border-radius:0.4em;
    border: 1px solid rgba(80, 80, 250, 0.4);
    box-sizing: border-box;
    text-decoration:none;
    font-family:'Roboto',sans-serif;
    //color:#1DA1F2;
    text-align:left;
    transition: background-color 1.0s;
}
.css_button1:hover{
    //text-decoration: underline;
    background-color:#e0e0ff;
    transition: background-color 0.3s;
}
</style>

<style>
.imgDark {
    transition: filter 0.3s ease;
}

.imgDark:hover {
    filter: brightness(0.8);
}
</style>
]]></pageHead>
      <top>0</top>
      <width>1083</width>
    </control>
    <control type="LayoutY" pathname="/divRoot/layouty1">
      <backgroundColor>000000</backgroundColor>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <height>785</height>
      <heightRatio>1</heightRatio>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <sizeRatio>0.724838411819021</sizeRatio>
      <top>0</top>
      <width>1083</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem1">
      <backgroundColor>FFFFFF</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <heavyEnabled>false</heavyEnabled>
      <height>60</height>
      <heightRatio>0.0764331210191083</heightRatio>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <sizeRatio>0.0554016620498615</sizeRatio>
      <top>0</top>
      <width>1083</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutX" pathname="/divRoot/layouty1/layoutyitem1/layoutx1">
      <dockX>right</dockX>
      <fieldCount>2</fieldCount>
      <height>35</height>
      <heightRatio>0.583333333333333</heightRatio>
      <layerVisible>false</layerVisible>
      <left>728</left>
      <leftRatio>0.672206832871653</leftRatio>
      <outerRight>50</outerRight>
      <sizeRatio>0.114754098360656</sizeRatio>
      <top>13</top>
      <topRatio>0.216666666666667</topRatio>
      <width>305</width>
      <widthRatio>0.281625115420129</widthRatio>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem1/layoutx1/layoutxitem1">
      <backgroundColor>008080</backgroundColor>
      <cursor>pointer</cursor>
      <fontBold>true</fontBold>
      <fontColor>FFFFFF</fontColor>
      <height>35</height>
      <heightRatio>1</heightRatio>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <onClick>g5.pageJump(g5.pageCurrent-1);</onClick>
      <sizeRatio>0.139442231075697</sizeRatio>
      <text>上一页</text>
      <top>0</top>
      <width>251</width>
      <widthRatio>0.822950819672131</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/layouty1/layoutyitem1/layoutx1/layoutxitem1/edit3">
      <backgroundSkin>edit2</backgroundSkin>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fontBold>true</fontBold>
      <fontColor>C0C0C0</fontColor>
      <height>35</height>
      <heightRatio>1</heightRatio>
      <inputFontBold>true</inputFontBold>
      <inputFontColor>198DC9</inputFontColor>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <sizeRatio>0.139442231075697</sizeRatio>
      <text>请输入模糊搜索文字</text>
      <top>0</top>
      <width>251</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem1/layoutx1/layoutxitem2">
      <backgroundColor>d0d0d0</backgroundColor>
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <heavyEnabled>false</heavyEnabled>
      <height>35</height>
      <heightRatio>1</heightRatio>
      <layerVisible>false</layerVisible>
      <left>251</left>
      <leftRatio>0.822950819672131</leftRatio>
      <sizeRatio>0.648148148148148</sizeRatio>
      <top>0</top>
      <width>54</width>
      <widthRatio>0.177049180327869</widthRatio>
    </control>
    <control type="Button" pathname="/divRoot/layouty1/layoutyitem1/layoutx1/layoutxitem2/button6">
      <backgroundSkin>TCloud000</backgroundSkin>
      <backgroundSkin1>LRBtn7</backgroundSkin1>
      <backgroundSkin2>LRBtn7</backgroundSkin2>
      <cursor>pointer</cursor>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fontColor>FFFFFF</fontColor>
      <fontColor1>FFFFFF</fontColor1>
      <fontColor2>FFFFFF</fontColor2>
      <height>35</height>
      <heightRatio>1</heightRatio>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <onClick>query();</onClick>
      <sizeRatio>0.648148148148148</sizeRatio>
      <top>0</top>
      <width>54</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem1/layoutx1/layoutxitem2/button6/panel119">
      <backgroundImg>qb23.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <height>23</height>
      <heightRatio>0.657142857142857</heightRatio>
      <layerVisible>false</layerVisible>
      <left>5</left>
      <leftRatio>0.0925925925925926</leftRatio>
      <outerBottom>8</outerBottom>
      <outerLeft>5</outerLeft>
      <outerRight>5</outerRight>
      <outerTop>4</outerTop>
      <sizeRatio>0.522727272727273</sizeRatio>
      <top>4</top>
      <topRatio>0.114285714285714</topRatio>
      <width>44</width>
      <widthRatio>0.814814814814815</widthRatio>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem2">
      <autoScroll>true</autoScroll>
      <backgroundColor>FF8000</backgroundColor>
      <height>686</height>
      <heightRatio>0.873885350318471</heightRatio>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <sizeRatio>0.63342566943675</sizeRatio>
      <top>60</top>
      <topRatio>0.0764331210191083</topRatio>
      <width>1083</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutX" pathname="/divRoot/layouty1/layoutyitem2/layoutx2">
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fieldCount>2</fieldCount>
      <height>686</height>
      <heightRatio>1</heightRatio>
      <left>0</left>
      <sizeRatio>0.63342566943675</sizeRatio>
      <top>0</top>
      <width>1083</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem2/layoutx2/layoutxitem3">
      <backgroundColor>f0f0f0</backgroundColor>
      <height>686</height>
      <heightRatio>1</heightRatio>
      <left>0</left>
      <sizeRatio>3.03030303030303</sizeRatio>
      <top>0</top>
      <width>542</width>
      <widthRatio>0.33</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/layoutx2/layoutxitem3/panel21">
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSize>14</fontSize>
      <height>686</height>
      <heightRatio>0.56268221574344</heightRatio>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <sizeRatio>0.712177121771218</sizeRatio>
      <text>等待数据...</text>
      <top>0</top>
      <topRatio>0.174927113702624</topRatio>
      <width>542</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/layoutx2/layoutxitem3/panel12">
      <backgroundColor>30B5EF</backgroundColor>
      <cursor>pointer</cursor>
      <fontBold>true</fontBold>
      <fontColor>808080</fontColor>
      <height>28</height>
      <heightRatio>0.0408163265306122</heightRatio>
      <layerVisible>false</layerVisible>
      <left>28</left>
      <leftRatio>0.0516605166051661</leftRatio>
      <onClick>g5.altCharts1();</onClick>
      <onCreate>sender.className = "buttonGray";
sender.style.borderRadius = "5px";</onCreate>
      <sizeRatio>0.212121212121212</sizeRatio>
      <text>切换图表模式</text>
      <top>27</top>
      <topRatio>0.0393586005830904</topRatio>
      <width>132</width>
      <widthRatio>0.243542435424354</widthRatio>
    </control>
    <control type="LayoutXItem" pathname="/divRoot/layouty1/layoutyitem2/layoutx2/layoutxitem4">
      <backgroundColor>d0d0d0</backgroundColor>
      <height>686</height>
      <heightRatio>1</heightRatio>
      <left>542</left>
      <leftRatio>0.33</leftRatio>
      <sizeRatio>2.94117647058824</sizeRatio>
      <top>0</top>
      <width>541</width>
      <widthRatio>0.34</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/layoutx2/layoutxitem4/panel11">
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSize>14</fontSize>
      <height>686</height>
      <heightRatio>1</heightRatio>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <leftRatio>0.312384473197782</leftRatio>
      <sizeRatio>1.26568265682657</sizeRatio>
      <text>等待数据...</text>
      <top>0</top>
      <topRatio>0.427113702623907</topRatio>
      <width>541</width>
      <widthRatio>1.00184842883549</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/layoutx2/layoutxitem4/panel14">
      <backgroundColor>30B5EF</backgroundColor>
      <cursor>pointer</cursor>
      <fontBold>true</fontBold>
      <fontColor>808080</fontColor>
      <height>28</height>
      <heightRatio>0.0408163265306122</heightRatio>
      <layerVisible>false</layerVisible>
      <left>46</left>
      <leftRatio>0.0850277264325323</leftRatio>
      <onClick>g5.altCharts2();</onClick>
      <onCreate>sender.className = "buttonGray";
sender.style.borderRadius = "5px";</onCreate>
      <sizeRatio>0.212121212121212</sizeRatio>
      <text>切换图表模式</text>
      <top>27</top>
      <topRatio>0.0393586005830904</topRatio>
      <width>132</width>
      <widthRatio>0.243992606284658</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem2/panel5">
      <backgroundImg>shadowY.png</backgroundImg>
      <backgroundImgMode>stretch</backgroundImgMode>
      <dockX>fill</dockX>
      <dockY>top</dockY>
      <height>18</height>
      <heightRatio>0.0262390670553936</heightRatio>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <outerTop>-7</outerTop>
      <sizeRatio>0.0166204986149585</sizeRatio>
      <top>-7</top>
      <topRatio>-0.0102040816326531</topRatio>
      <width>1083</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="LayoutYItem" pathname="/divRoot/layouty1/layoutyitem6">
      <backgroundColor>F4F4F4</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <heavy>55</heavy>
      <heavyEnabled>false</heavyEnabled>
      <height>39</height>
      <heightRatio>0.0496815286624204</heightRatio>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <sizeRatio>0.03601108033241</sizeRatio>
      <top>746</top>
      <topRatio>0.95031847133758</topRatio>
      <width>1083</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/layouty1/layoutyitem6/panel13">
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>fill</dockX>
      <dockY>top</dockY>
      <height>1</height>
      <heightRatio>0.0256410256410256</heightRatio>
      <left>0</left>
      <leftRatio>0.290858725761773</leftRatio>
      <sizeRatio>0.01</sizeRatio>
      <top>0</top>
      <width>1083</width>
      <widthRatio>0.0923361034164358</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1">
      <aniAlpha>appear:渐变出现</aniAlpha>
      <aniPos>leftFlyIn:左侧飞入</aniPos>
      <backgroundColor>008080</backgroundColor>
      <backgroundSkin>edit2</backgroundSkin>
      <cursor>pointer</cursor>
      <dockX>center</dockX>
      <dockY>center</dockY>
      <fontColor>727272</fontColor>
      <height>571</height>
      <heightRatio>0.727388535031847</heightRatio>
      <layerName>创建/编辑用户</layerName>
      <layerVisible>false</layerVisible>
      <left>232</left>
      <leftRatio>0.214219759926131</leftRatio>
      <sizeRatio>0.922455573505654</sizeRatio>
      <top>107</top>
      <topRatio>0.136305732484076</topRatio>
      <width>619</width>
      <widthRatio>0.571560480147738</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel2">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSize>14</fontSize>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>28</left>
      <leftRatio>0.0452342487883683</leftRatio>
      <sizeRatio>0.168224299065421</sizeRatio>
      <text>用户信息资料卡</text>
      <top>14</top>
      <topRatio>0.0245183887915937</topRatio>
      <width>214</width>
      <widthRatio>0.345718901453958</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel3">
      <backgroundColor>198DC9</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <dockX>fill</dockX>
      <height>2</height>
      <heightRatio>0.00350262697022767</heightRatio>
      <layerVisible>false</layerVisible>
      <left>30</left>
      <leftRatio>0.0484652665589661</leftRatio>
      <outerLeft>30</outerLeft>
      <outerRight>30</outerRight>
      <sizeRatio>0.0035778175313059</sizeRatio>
      <top>52</top>
      <topRatio>0.0910683012259194</topRatio>
      <width>559</width>
      <widthRatio>0.903069466882068</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel4">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>60</left>
      <leftRatio>0.0969305331179321</leftRatio>
      <sizeRatio>0.5</sizeRatio>
      <text>用户ID</text>
      <top>66</top>
      <topRatio>0.115586690017513</topRatio>
      <width>72</width>
      <widthRatio>0.116316639741519</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel6">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>61</left>
      <leftRatio>0.098546042003231</leftRatio>
      <sizeRatio>0.507042253521127</sizeRatio>
      <text>用户名</text>
      <top>104</top>
      <topRatio>0.182136602451839</topRatio>
      <width>71</width>
      <widthRatio>0.11470113085622</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel7">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>61</left>
      <leftRatio>0.098546042003231</leftRatio>
      <sizeRatio>0.48</sizeRatio>
      <text>备注信息</text>
      <top>329</top>
      <topRatio>0.576182136602452</topRatio>
      <width>75</width>
      <widthRatio>0.121163166397415</widthRatio>
    </control>
    <control type="Button" pathname="/divRoot/panel1/button1">
      <backgroundSkin>TCloud000</backgroundSkin>
      <backgroundSkin1>LRBtn7</backgroundSkin1>
      <backgroundSkin2>LRBtn7</backgroundSkin2>
      <cursor>pointer</cursor>
      <fontBold>true</fontBold>
      <fontColor>FFFFFF</fontColor>
      <fontColor1>FFFFFF</fontColor1>
      <fontColor2>FFFFFF</fontColor2>
      <height>39</height>
      <heightRatio>0.0683012259194396</heightRatio>
      <layerVisible>false</layerVisible>
      <left>407</left>
      <leftRatio>0.65751211631664</leftRatio>
      <onClick>if (g5.operation == "new") {
    addNew();
} else if (g5.operation == "edit") {
    modify();
}
</onClick>
      <sizeRatio>0.276595744680851</sizeRatio>
      <text>　确 定</text>
      <top>498</top>
      <topRatio>0.87215411558669</topRatio>
      <width>141</width>
      <widthRatio>0.227786752827141</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/button1/panel15">
      <backgroundImg>i087_10.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <height>18</height>
      <heightRatio>0.461538461538462</heightRatio>
      <layerVisible>false</layerVisible>
      <left>30</left>
      <leftRatio>0.212765957446809</leftRatio>
      <outerBottom>5</outerBottom>
      <outerLeft>5</outerLeft>
      <outerRight>5</outerRight>
      <outerTop>5</outerTop>
      <sizeRatio>0.642857142857143</sizeRatio>
      <top>8</top>
      <topRatio>0.205128205128205</topRatio>
      <width>28</width>
      <widthRatio>0.198581560283688</widthRatio>
    </control>
    <control type="Button" pathname="/divRoot/panel1/button3">
      <backgroundSkin>ProjectAdmin001</backgroundSkin>
      <backgroundSkin1>LRBtn7</backgroundSkin1>
      <backgroundSkin2>LRBtn7</backgroundSkin2>
      <cursor>pointer</cursor>
      <fontBold>true</fontBold>
      <fontColor>FFFFFF</fontColor>
      <fontColor1>FFFFFF</fontColor1>
      <fontColor2>FFFFFF</fontColor2>
      <height>39</height>
      <heightRatio>0.0683012259194396</heightRatio>
      <layerVisible>false</layerVisible>
      <left>250</left>
      <leftRatio>0.403877221324717</leftRatio>
      <onClick>ee.setVisible(ee.getControl("panel1"), false);</onClick>
      <sizeRatio>0.276595744680851</sizeRatio>
      <text>　取 消</text>
      <top>498</top>
      <topRatio>0.87215411558669</topRatio>
      <width>141</width>
      <widthRatio>0.227786752827141</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/button3/panel8">
      <backgroundImg>i087_01.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <height>18</height>
      <heightRatio>0.461538461538462</heightRatio>
      <layerVisible>false</layerVisible>
      <left>30</left>
      <leftRatio>0.212765957446809</leftRatio>
      <outerBottom>5</outerBottom>
      <outerLeft>5</outerLeft>
      <outerRight>5</outerRight>
      <outerTop>5</outerTop>
      <sizeRatio>0.642857142857143</sizeRatio>
      <top>8</top>
      <topRatio>0.205128205128205</topRatio>
      <width>28</width>
      <widthRatio>0.198581560283688</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel9">
      <backgroundImg>i087_01000.png</backgroundImg>
      <backgroundImgMode>fill</backgroundImgMode>
      <cursor>pointer</cursor>
      <dockX>right</dockX>
      <dockY>top</dockY>
      <height>25</height>
      <heightRatio>0.0437828371278459</heightRatio>
      <layerVisible>false</layerVisible>
      <left>560</left>
      <leftRatio>0.904684975767367</leftRatio>
      <onClick>ee.setVisible(ee.getControl("panel1"), false);</onClick>
      <outerBottom>5</outerBottom>
      <outerLeft>5</outerLeft>
      <outerRight>20</outerRight>
      <outerTop>15</outerTop>
      <sizeRatio>0.641025641025641</sizeRatio>
      <top>15</top>
      <topRatio>0.0262697022767075</topRatio>
      <width>39</width>
      <widthRatio>0.0630048465266559</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/panel1/edit1">
      <backgroundSkin>edit2</backgroundSkin>
      <height>140</height>
      <heightRatio>0.245183887915937</heightRatio>
      <inputFontBold>true</inputFontBold>
      <inputFontColor>808080</inputFontColor>
      <layerVisible>false</layerVisible>
      <left>133</left>
      <leftRatio>0.21486268174475</leftRatio>
      <multiLine>true</multiLine>
      <sizeRatio>0.334928229665072</sizeRatio>
      <top>339</top>
      <topRatio>0.59369527145359</topRatio>
      <width>418</width>
      <widthRatio>0.675282714054927</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/panel1/edit2">
      <backgroundSkin>edit2</backgroundSkin>
      <fontBold>true</fontBold>
      <fontColor>C0C0C0</fontColor>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <inputFontBold>true</inputFontBold>
      <inputFontColor>808080</inputFontColor>
      <layerVisible>false</layerVisible>
      <left>133</left>
      <leftRatio>0.21486268174475</leftRatio>
      <sizeRatio>0.0861244019138756</sizeRatio>
      <text>登录系统用，长度3个英文字母或数字以上，不区分大小写</text>
      <top>105</top>
      <topRatio>0.183887915936953</topRatio>
      <width>418</width>
      <widthRatio>0.675282714054927</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel10">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>133</left>
      <leftRatio>0.21486268174475</leftRatio>
      <sizeRatio>0.346153846153846</sizeRatio>
      <text>0</text>
      <top>66</top>
      <topRatio>0.115586690017513</topRatio>
      <width>104</width>
      <widthRatio>0.168012924071082</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel33">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>61</left>
      <leftRatio>0.098546042003231</leftRatio>
      <sizeRatio>0.507042253521127</sizeRatio>
      <text>账户密码</text>
      <top>142</top>
      <topRatio>0.248686514886165</topRatio>
      <width>71</width>
      <widthRatio>0.11470113085622</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/panel1/edit4">
      <backgroundSkin>edit2</backgroundSkin>
      <fontBold>true</fontBold>
      <fontColor>C0C0C0</fontColor>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <inputFontBold>true</inputFontBold>
      <inputFontColor>808080</inputFontColor>
      <inputPassword>true</inputPassword>
      <layerVisible>false</layerVisible>
      <left>133</left>
      <leftRatio>0.21486268174475</leftRatio>
      <sizeRatio>0.0861244019138756</sizeRatio>
      <text>英文字母数字或标点符号，至少6位，区分大小写</text>
      <top>143</top>
      <topRatio>0.250437828371278</topRatio>
      <width>418</width>
      <widthRatio>0.675282714054927</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel34">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>61</left>
      <leftRatio>0.098546042003231</leftRatio>
      <sizeRatio>0.507042253521127</sizeRatio>
      <text>确认密码</text>
      <top>180</top>
      <topRatio>0.31523642732049</topRatio>
      <width>71</width>
      <widthRatio>0.11470113085622</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/panel1/edit5">
      <backgroundSkin>edit2</backgroundSkin>
      <fontBold>true</fontBold>
      <fontColor>C0C0C0</fontColor>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <inputFontBold>true</inputFontBold>
      <inputFontColor>808080</inputFontColor>
      <inputPassword>true</inputPassword>
      <layerVisible>false</layerVisible>
      <left>133</left>
      <leftRatio>0.21486268174475</leftRatio>
      <sizeRatio>0.0861244019138756</sizeRatio>
      <text>再次输入一遍刚才的密码</text>
      <top>181</top>
      <topRatio>0.316987740805604</topRatio>
      <width>418</width>
      <widthRatio>0.675282714054927</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel27">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>61</left>
      <leftRatio>0.098546042003231</leftRatio>
      <sizeRatio>0.507042253521127</sizeRatio>
      <text>用户昵称</text>
      <top>218</top>
      <topRatio>0.381786339754816</topRatio>
      <width>71</width>
      <widthRatio>0.11470113085622</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/panel1/edit6">
      <backgroundSkin>edit2</backgroundSkin>
      <fontBold>true</fontBold>
      <fontColor>C0C0C0</fontColor>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <inputFontBold>true</inputFontBold>
      <inputFontColor>808080</inputFontColor>
      <layerVisible>false</layerVisible>
      <left>133</left>
      <leftRatio>0.21486268174475</leftRatio>
      <sizeRatio>0.0861244019138756</sizeRatio>
      <text>汉字组成的方便识别的名字，最好取真实姓名，至少2个字符或汉字</text>
      <top>219</top>
      <topRatio>0.38353765323993</topRatio>
      <width>418</width>
      <widthRatio>0.675282714054927</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel32">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>61</left>
      <leftRatio>0.098546042003231</leftRatio>
      <sizeRatio>0.507042253521127</sizeRatio>
      <text>联系手机</text>
      <top>256</top>
      <topRatio>0.448336252189142</topRatio>
      <width>71</width>
      <widthRatio>0.11470113085622</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/panel1/edit7">
      <backgroundSkin>edit2</backgroundSkin>
      <fontBold>true</fontBold>
      <fontColor>C0C0C0</fontColor>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <inputFontBold>true</inputFontBold>
      <inputFontColor>808080</inputFontColor>
      <layerVisible>false</layerVisible>
      <left>133</left>
      <leftRatio>0.21486268174475</leftRatio>
      <sizeRatio>0.0861244019138756</sizeRatio>
      <text>方便联系的手机号码，可不填写</text>
      <top>257</top>
      <topRatio>0.450087565674256</topRatio>
      <width>418</width>
      <widthRatio>0.675282714054927</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel1/panel35">
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <hAlign>left</hAlign>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <layerVisible>false</layerVisible>
      <left>61</left>
      <leftRatio>0.098546042003231</leftRatio>
      <sizeRatio>0.507042253521127</sizeRatio>
      <text>公司ID</text>
      <top>294</top>
      <topRatio>0.514886164623468</topRatio>
      <width>71</width>
      <widthRatio>0.11470113085622</widthRatio>
    </control>
    <control type="Edit" pathname="/divRoot/panel1/edit8">
      <backgroundSkin>edit2</backgroundSkin>
      <fontBold>true</fontBold>
      <fontColor>C0C0C0</fontColor>
      <height>36</height>
      <heightRatio>0.0630472854640981</heightRatio>
      <inputFontBold>true</inputFontBold>
      <inputFontColor>808080</inputFontColor>
      <layerVisible>false</layerVisible>
      <left>133</left>
      <leftRatio>0.21486268174475</leftRatio>
      <sizeRatio>0.0861244019138756</sizeRatio>
      <text>此项仅供后台操作员填写</text>
      <top>295</top>
      <topRatio>0.516637478108581</topRatio>
      <width>418</width>
      <widthRatio>0.675282714054927</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel38">
      <backgroundSkin>empty</backgroundSkin>
      <dockX>fill</dockX>
      <dockY>fill</dockY>
      <fontBold>true</fontBold>
      <fontColor>198DC9</fontColor>
      <fontFamily>黑体</fontFamily>
      <fontSize>14</fontSize>
      <hAlign>left</hAlign>
      <height>785</height>
      <heightRatio>1</heightRatio>
      <layerName>p1 主页透明弹窗</layerName>
      <layerVisible>false</layerVisible>
      <left>0</left>
      <onClick><![CDATA[for (var i=0; i<sender.eeChildren.length; i++) {
    if (sender.eeChildren[i].close) {
        sender.eeChildren[i].close();
    } else {
        ee.setVisible(sender.eeChildren[i], false);
    }
}
ee.setVisible(sender, false);]]></onClick>
      <onCreate>sender.a1 = ee.getControl("panel39");</onCreate>
      <sizeRatio>0.724838411819021</sizeRatio>
      <top>0</top>
      <width>1083</width>
      <widthRatio>1</widthRatio>
    </control>
    <control type="Panel" pathname="/divRoot/panel38/panel39">
      <backgroundColor>FAFAFA</backgroundColor>
      <bgColorEnabled>true</bgColorEnabled>
      <height>482</height>
      <heightRatio>0.614012738853503</heightRatio>
      <layerName>a1 弹出菜单</layerName>
      <layerVisible>false</layerVisible>
      <left>167</left>
      <leftRatio>0.154201292705448</leftRatio>
      <onCreate><![CDATA[sender.c_items = new Array();
sender.style.boxSizing="border-box";
sender.style.borderWidth = "1px";
sender.style.borderColor = "#a0a0a0";
sender.style.borderStyle = "solid";
sender.style.borderRadius = "10px";
sender.style.boxShadow  = "5px 5px 10px #d0d0d0";

sender.show = function(refDiv, list, onComplete) {
    var options = list.split(";");
    var i = 0;
    while (i<options.length) {
        if (options[i].trim()=="") {
            options.splice(i, 1);
        } else {
            i++;
        }
    }
    this.itemsClear();
    var root;
    var maxX = 0;
    for (var i=0; i<options.length; i++) {
        root = this.itemsAdd(options[i].split(","));
        root.v_index = i;
        this.c_items.push(root);
        var rect = eb.getDivRectSetting(root);
        if (rect.w>maxX) maxX = rect.w;
    }
    this.v_result = new Array();
    this.v_resultIndex = -1;
    this.f_onComplete = onComplete;
    ee.setRect(this,null,null,parseInt(maxX*1.3),null);
    eb.processDock();
    ee.tiledV(this, 0, 10, 10);
    ee.tiledResizeV(this, 1);
    var rect = g5.getRectAbs(refDiv);
    if (rect.y > eb.getDivRect(ee.getControl("divRoot")).h/2) {
        ee.setRect(this, rect.x - 50, rect.y - eb.getDivRect(this).h - 10, null, null);
    } else {
        ee.setRect(this, rect.x - 50, rect.y+rect.h+10, null, null);
    }
    ee.setVisible(this, true);
    ee.setVisible(this.parentNode, true);
}

sender.close = function() {
    ee.setVisible(this, false);
    this.f_onComplete(this.v_resultIndex, this.v_result);
}

sender.itemsClear = function() {
    while (this.c_items.length>0) {
        ee.removeControl(this.c_items[this.c_items.length-1]);
        this.c_items.splice(this.c_items.length-1, 1);
    }
}

sender.itemsAdd = function(value) {
    var c;
    var root;
    root = createPanel(this, this.id + "panel" + value[1], "", 10, 10, 1, 50);
    root.v_value = value;
    root.className = "buttonSelectBlue";
    root.style.cursor = "pointer";
    eb.setDock(root,"fill","disabled");
    eb.setOuter(root,0,0,1,0);
    ee.setOnClick(root, function(senderBtn,event) {
        sender.v_result = root.v_value;
        sender.v_resultIndex = root.v_index;
        //window.event? window.event.cancelBubble = true : event.stopPropagation();
    });
    
    c = createPanel(root, root.id+"panel16", "", 10, 10, 10, 22);
    addText(c, root.v_value[0], "left", "middle", "微软雅黑", 12, "14171a", "bold");
    c.label.style.whiteSpace = "nowrap";
    eb.setDock(c,"fill","disabled");
    eb.setOuter(c,10,0,10,0);
    var rect = eb.getDivRect(c.label);
    ee.setRect(root, null, null, rect.w + 20, null);

    return root;
}
]]></onCreate>
      <sizeRatio>1.19012345679012</sizeRatio>
      <top>101</top>
      <topRatio>0.128662420382166</topRatio>
      <width>405</width>
      <widthRatio>0.373961218836565</widthRatio>
    </control>
  </controls>
  <taskSet count="9">
    <taskSetItem name="query">
      <script1>eio.appendString8(eb.getCookie("FAToken")); 
</script1>
      <script2><![CDATA[var token = eio.readString8();

var sql,sqlResult;
sql = "exec getUserInfoBySessionAdmin '" + db.encode(token) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("token失效");
    es.logWarning("用户token失效, sql=" + sql);
    return;
}   
var userId = db.getString(sqlResult, "id");
var userName = db.getString(sqlResult, "userName");

sql= 
    "exec [viewSiteFlowByDay] ";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
eio.appendString8("T");
eio.appendDataSet(sqlResult,"dayNumber,count",
    0,9999
); 
db.nextResult(sqlResult);
eio.appendDataSet(sqlResult,"dayNumber,count",
    0,9999
); 
db.nextResult(sqlResult);
eio.appendDataSet(sqlResult,"dayNumber,count",
    0,9999
); 
]]></script2>
      <script3><![CDATA[if (eio.readString8() != "T") {
    alert("无法获取您需要的数据：" + eio.readString8());
    return;
}

query.dataset1 = eio.readDataSet();
query.dataset2 = eio.readDataSet();
query.dataset3 = eio.readDataSet();
g5.initCharts();
//ee.setTableData(ee.getControl("tablebody2"), query.dataset,0);   
//ee.setText(ee.getControl("layoutxitem45"), g5.pageCurrent + "/" + g5.pageCount);
//ee.setText(ee.getControl("panel16"), "共找到" +
//    "<font color = '#d00000'>" + query.recordCount + "条</font>记录");
]]></script3>
    </taskSetItem>
    <taskSetItem name="del">
      <script1>eio.appendString8(eb.getCookie("loginToken"));
eio.appendInt32(parseInt(g5.userId));</script1>
      <script2><![CDATA[var token = eio.readString8();
var deleteUserId = eio.readInt32();

//获取用户信息及认证
var sql,sqlResult;
sql = "exec getUserInfoBySession '" + db.encode(token) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("您已经长时间没有登录系统了，请返回登录页面重新登录");
    es.logWarning("用户token失效, sql=" + sql);
    return;
}   
var userId = db.getString(sqlResult, "id");
var companyId = db.getString(sqlResult, "companyId");

//修改
sql = "exec userDelete " +
    userId + "," +
    deleteUserId;
sqlResult = db.executeQuery("DB", sql); 
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode") < 0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    return;
}

eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));
]]></script2>
      <script3>if (eio.readString8() != "T") {
    alert("无法删除用户账户：" + eio.readString8());
    return;
}

alert("删除用户账户完成");
query();</script3>
    </taskSetItem>
    <taskSetItem name="addNew">
      <script1><![CDATA[var username = ee.getEditText(ee.getControl("edit2"));
var password1 = ee.getEditText(ee.getControl("edit4"));
var password2 = ee.getEditText(ee.getControl("edit5"));
var nickName = ee.getEditText(ee.getControl("edit6"));
var mobile = ee.getEditText(ee.getControl("edit7"));
var companyId = ee.getEditText(ee.getControl("edit8"));
var note = ee.getEditText(ee.getControl("edit1"));

if (username.length < 3) {
    alert("用户名长度不能小于3");
    return;
}
if (password1 == "") {
    alert("密码不能为空");
    return;
}
if (password1.length < 6) {
    alert("密码长度不能少于6位");
    return;
}
if (password1 != password2) {
    alert("两次输入的密码不一致");
    return;
}
if (nickName.length < 2) {
    alert("昵称长度必须是2位以上");
    return;
}

companyId = parseInt(companyId);
if (isNaN(companyId)) {
    companyId = -1;
}
eio.appendString8(eb.getCookie("loginToken"));
eio.appendString8(username);
eio.appendString8(password1);
eio.appendString8(nickName);
eio.appendString8(mobile);
eio.appendInt32(companyId);
eio.appendString16(note);
]]></script1>
      <script2><![CDATA[var token = eio.readString8();
var username = eio.readString8();
var password = eio.readString8();
var nickName = eio.readString8();
var mobile = eio.readString8();
var userCompanyId = eio.readInt32();
var note = eio.readString16();

//获取用户信息及认证
var sql,sqlResult;
sql = "exec getUserInfoBySession '" + db.encode(token) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("您已经长时间没有登录系统了，请返回登录页面重新登录");
    es.logWarning("用户token失效, sql=" + sql);
    return;
}   
var userId = db.getString(sqlResult, "id");
var companyId = db.getString(sqlResult, "companyId");

//创建
sql = "exec userCreate " +
    userId + "," +
    "'" + db.encode(username) + "'," +
    "'" + db.encode(es.getMd5(password)) + "'," +
    userCompanyId + "," +
    "'" + db.encode(mobile) + "'," +
    "'" + db.encode(nickName) + "'," +
    "'" + db.encode(note) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode") < 0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    return;
}

eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));
]]></script2>
      <script3>if (eio.readString8() != "T") {
    alert("无法创建用户：" + eio.readString8());
    return;
}

alert("创建用户成功");
ee.setVisible(ee.getControl("panel1"), false);
query();</script3>
    </taskSetItem>
    <taskSetItem name="modify">
      <script1><![CDATA[var modifyUserId = ee.getText(ee.getControl("panel10"));
var username = ee.getEditText(ee.getControl("edit2"));
var password1 = ee.getEditText(ee.getControl("edit4"));
var password2 = ee.getEditText(ee.getControl("edit5"));
var nickName = ee.getEditText(ee.getControl("edit6"));
var mobile = ee.getEditText(ee.getControl("edit7"));
var companyId = ee.getEditText(ee.getControl("edit8"));
var note = ee.getEditText(ee.getControl("edit1"));

if ((password1 != "") || (password2 != "")) {
    alert("系统注意到您输入了密码，修改密码必须本人操作，您无权在这里修改他人的密码，所以您输入的密码会被忽略。 ");
}
if (companyId != "") {
    alert("您输入companyId是不必要的，系统将忽略您的输入");
}
if (nickName.length < 2) {
    alert("修改后的昵称长度不能少于2个字符或者汉字");
    return;
}

eio.appendString8(eb.getCookie("loginToken"));
eio.appendInt32(parseInt(modifyUserId));
eio.appendString8(nickName);
eio.appendString8(mobile);
eio.appendString16(note);
]]></script1>
      <script2><![CDATA[var token = eio.readString8();
var modifyUserId = eio.readInt32();
var nickName = eio.readString8();
var mobile = eio.readString8();
var note = eio.readString16(); 

//获取用户信息及认证
var sql,sqlResult;
sql = "exec getUserInfoBySession '" + db.encode(token) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("您已经长时间没有登录系统了，请返回登录页面重新登录");
    es.logWarning("用户token失效, sql=" + sql);
    return;
}   
var userId = db.getString(sqlResult, "id");
var companyId = db.getString(sqlResult, "companyId");

//修改
sql = "exec userModify " +
    userId + "," +
    modifyUserId + "," +
    "'" + db.encode(mobile) + "'," +
    "'" + db.encode(nickName) + "'," +
    "'" + db.encode(note) + "'";
    
sqlResult = db.executeQuery("DB", sql); 
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode") < 0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    return;
}

eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));
]]></script2>
      <script3>if (eio.readString8() != "T") {
    alert("无法修改用户信息：" + eio.readString8());
    return;
}

alert("修改用户信息完成");
ee.setVisible(ee.getControl("panel1"), false);
query();</script3>
    </taskSetItem>
    <taskSetItem name="disableUser">
      <script1>//封号/解封, userId,operation,onComplete()
if (disableUser.busy) return;
disableUser.busy = true;
eio.appendString16(eb.getCookie("FAToken"));
eio.appendString16(disableUser.userId);
eio.appendString16(disableUser.operation);
</script1>
      <script2><![CDATA[var token = eio.readString16();
var disableUserId = parseInt(eio.readString16());
var operation = parseInt(eio.readString16());

//获取用户信息及认证
var sql,sqlResult;
sql = "exec getUserInfoBySessionAdmin '" + db.encode(token) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("token失效");
    es.logWarning("用户token失效, sql=" + sql);
    return;
}   
var userId = db.getString(sqlResult, "id");
var userName = db.getString(sqlResult, "userName");

sql = "exec userDisable " +
    userId + "," +
    disableUserId + "," +
    operation;
sqlResult = db.executeQuery("DB", sql); 
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode") != 0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    return;
}

eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));
]]></script2>
      <script3>if (eio.readString8() != "T") {
    disableUser.busy = false;
    alert("操作失败：" + eio.readString8());
    return;
}

if (disableUser.onComplete) disableUser.onComplete();
disableUser.busy = false;
</script3>
    </taskSetItem>
    <taskSetItem name="freezeUser">
      <script1>//userId,operation,onComplete()
if (freezeUser.busy) return;
freezeUser.busy = true;
eio.appendString16(eb.getCookie("FAToken"));
eio.appendString16(freezeUser.userId);
eio.appendString16(freezeUser.operation);
</script1>
      <script2><![CDATA[var token = eio.readString16();
var disableUserId = parseInt(eio.readString16());
var operation = parseInt(eio.readString16());

//获取用户信息及认证
var sql,sqlResult;
sql = "exec getUserInfoBySessionAdmin '" + db.encode(token) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("token失效");
    es.logWarning("用户token失效, sql=" + sql);
    return;
}   
var userId = db.getString(sqlResult, "id");
var userName = db.getString(sqlResult, "userName");

sql = "exec userFreeze " +
    userId + "," +
    disableUserId + "," +
    operation;
sqlResult = db.executeQuery("DB", sql); 
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode") != 0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    return;
}

eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));
]]></script2>
      <script3>if (eio.readString8() != "T") {
    freezeUser.busy = false;
    alert("操作失败：" + eio.readString8());
    return;
}

if (freezeUser.onComplete) freezeUser.onComplete();
freezeUser.busy = false;
</script3>
    </taskSetItem>
    <taskSetItem name="setUserStatus">
      <script1>//userId,newStatus,onComplete()
if (setUserStatus.busy) return;
setUserStatus.busy = true;
eio.appendString16(eb.getCookie("FAToken"));
eio.appendString16(setUserStatus.userId);
eio.appendString16(setUserStatus.newStatus);
</script1>
      <script2><![CDATA[var token = eio.readString16();
var userId = parseInt(eio.readString16());
var newStatus = eio.readString16();

//获取用户信息及认证
var sql,sqlResult;
sql = "exec getUserInfoBySessionAdmin '" + db.encode(token) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("token失效");
    es.logWarning("用户token失效, sql=" + sql);
    return;
}   
var myUserId = db.getString(sqlResult, "id");
var myUserName = db.getString(sqlResult, "userName");

sql = "exec userSetStatus " +
    myUserId + "," +
    userId + "," +
    db.encode(newStatus);
sqlResult = db.executeQuery("DB", sql); 
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode") != 0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    return;
}

eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));
]]></script2>
      <script3>if (eio.readString8() != "T") {
    setUserStatus.busy = false;
    alert("操作失败：" + eio.readString8());
    return;
}

if (setUserStatus.onComplete) setUserStatus.onComplete();
setUserStatus.busy = false;
</script3>
    </taskSetItem>
    <taskSetItem name="delFollow">
      <script1>//userId,onComplete(result)
if (delFollow.busy) return;
delFollow.busy = true;
eio.appendString16(eb.getCookie("FAToken"));
eio.appendString16(delFollow.userId);
</script1>
      <script2><![CDATA[var token = eio.readString16();
var opUserId = parseInt(eio.readString16());

//获取用户信息及认证
var sql,sqlResult;
sql = "exec getUserInfoBySessionAdmin '" + db.encode(token) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("token失效");
    es.logWarning("用户token失效, sql=" + sql);
    return;
}   
var userId = db.getString(sqlResult, "id");
var userName = db.getString(sqlResult, "userName");

sql = "exec userDeleteFollow " +
    userId + "," +
    opUserId + ";";
sqlResult = db.executeQuery("DB", sql); 
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode") != 0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    return;
}

eio.appendString8("T");
eio.appendString16(db.getString(sqlResult, "errorString"));
]]></script2>
      <script3>if (eio.readString8() != "T") {
    delFollow.busy = false;
    alert("操作失败：" + eio.readString8());
    return;
}

delFollow.result = eio.readString16();
if (delFollow.onComplete) delFollow.onComplete(delFollow.result);
delFollow.busy = false;
</script3>
    </taskSetItem>
    <taskSetItem name="changePassword">
      <script1>//userId,newPassword,onComplete()
if (changePassword.busy) return;
changePassword.busy = true;
eio.appendString16(eb.getCookie("FAToken"));
eio.appendString16(changePassword.userId);
eio.appendString16(changePassword.newPassword);</script1>
      <script2><![CDATA[var token = eio.readString16();
var userId = parseInt(eio.readString16());
var newPassword = eio.readString16();

//获取用户信息及认证
var sql,sqlResult;
sql = "exec getUserInfoBySessionAdmin '" + db.encode(token) + "'";
sqlResult = db.executeQuery("DB", sql);
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getString(sqlResult, "sessionId").length < 5) {
    eio.appendString8("F");
    eio.appendString8("token失效");
    es.logWarning("用户token失效, sql=" + sql);
    return;
}   
var myUserId = db.getString(sqlResult, "id");
var myUserName = db.getString(sqlResult, "userName");

sql = "exec userSetPassword " +
    myUserId + "," +
    userId + "," +
    "'" + db.encode(es.getMd5(newPassword)) + "'";
sqlResult = db.executeQuery("DB", sql); 
if (sqlResult == null) {
    eio.appendString8("F");
    es.logWarning("数据库执行错误, sql=" + sql);
    return;
}
db.read(sqlResult);
if (db.getInt32(sqlResult, "errorCode") != 0) {
    eio.appendString8("F");
    eio.appendString8(db.getString(sqlResult, "errorString"));
    return;
}

eio.appendString8("T");
eio.appendString8(db.getString(sqlResult, "errorString"));












]]></script2>
      <script3>if (eio.readString8() != "T") {
    changePassword.busy = false;
    alert("操作失败：" + eio.readString8());
    return;
}

if (changePassword.onComplete) changePassword.onComplete();
changePassword.busy = false;
</script3>
    </taskSetItem>
  </taskSet>
  <gridLines count="0" />
  <g5Items count="11">
    <item name="imgUrl" type="10">
      <varValue>"/incoming/";</varValue>
      <functionParam />
      <functionCode />
    </item>
    <item name="tableClick" type="20">
      <varValue />
      <functionParam>sender</functionParam>
      <functionCode><![CDATA[//鼠标点击行激活处理,接口：valid,y
var c, x, y;
for (y = 0; y < g5.pageSize; y++) {
    for (x = 0; x < 6; x++) {
        c = ee.getTableCell(ee.getControl("tablebody2"), x, y);
        c.style.backgroundColor = "";    
    }
}
for (x = 0; x < 6; x++) {
    c = ee.getTableCell(ee.getControl("tablebody2"), x, sender.rowIndex);
    c.style.backgroundColor = "rgba(50, 50, 255, 0.1)"; //"#f0E0EEFF";
}
g5.tableClick.valid = false;
if (eb.isEmpty(query.dataset)) return;
g5.tableClick.y = sender.rowIndex;
if (g5.tableClick.y>=query.dataset.rowCount) return;
g5.tableClick.valid = true;
]]></functionCode>
    </item>
    <item name="getRectAbs" type="20">
      <varValue />
      <functionParam>div</functionParam>
      <functionCode>var rect = eb.getDivRect(div);
var result = eb.getDivRect(div);
while (true) {
    div = div.parentNode;
    if (eb.isEmpty(div)) break;
    if (div.id == "divRoot") break;
    rect = eb.getDivRect(div);
    result.x+=rect.x-div.scrollLeft;
    result.y+=rect.y-div.scrollTop;
}
result.y -= document.documentElement.scrollTop;
return result;</functionCode>
    </item>
    <item name="getUtcTime" type="20">
      <varValue />
      <functionParam>dbTime,returnString</functionParam>
      <functionCode><![CDATA[//04 19 2020 10:35 UTC
//yyyy-mm-dd hh:nn:ss
//0123456789012345678
if (dbTime.length!=19) return new Date();

var r = new Date(Date.UTC(
    parseInt(dbTime.substr(0,4)),
    parseInt(dbTime.substr(5,2)) - 1,
    parseInt(dbTime.substr(8,2)),
    parseInt(dbTime.substr(11,2)),
    parseInt(dbTime.substr(14,2)),
    parseInt(dbTime.substr(17,2))
));

if (returnString) {
    return ((r.getYear()<1000)?(r.getYear()+1900):r.getYear()) + "-" +
        ((r.getMonth()+1)<10?"0":"") + (r.getMonth()+1) + "-" +
        (r.getDate()<10?"0":"") + r.getDate() + " " +
        (r.getHours()<10?"0":"") + r.getHours() + ":" +
        (r.getMinutes()<10?"0":"") + r.getMinutes() + ":" +
        (r.getSeconds()<10?"0":"") + r.getSeconds();
} else {
    return r;
} 
]]></functionCode>
    </item>
    <item name="getQueryString" type="20">
      <varValue />
      <functionParam>paramName</functionParam>
      <functionCode>var reg = new RegExp("(^|&amp;)"+ paramName +"=([^&amp;]*)(&amp;|$)");
var r = window.location.search.substr(1).match(reg);
if(r!=null)return  unescape(r[2]); return null;
</functionCode>
    </item>
    <item name="getIPInfo" type="20">
      <varValue />
      <functionParam>ip,onComplete</functionParam>
      <functionCode><![CDATA[const apiUrl = `https://ipinfo.io/${ip}/json`;
fetch(apiUrl)
.then(response => response.json())
.then(data => {
    onComplete(data.ip,data.city,data.region,data.country,data.loc);      
})
.catch(error => {
    console.error("发生错误:", error);
});]]></functionCode>
    </item>
    <item name="initCharts" type="20">
      <varValue />
      <functionParam />
      <functionCode>google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(g5.drawCharts1);


google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(g5.drawCharts2);

</functionCode>
    </item>
    <item name="drawCharts1" type="20">
      <varValue />
      <functionParam />
      <functionCode><![CDATA[var rawData = new Array();
rawData.push(
    ["日期", "独立IP数量", "独立用户数量"]
);

for (var i = 0; i<query.dataset1.rowCount; i++) {
    var s = query.dataset1.getData(0,i);
    s = s.split("-");
    if (s.length!=3) continue;
    rawData.push([
        new Date(parseInt(s[0]),parseInt(s[1])-1,parseInt(s[2])),
        parseInt(query.dataset1.getData(1,i)),
        parseInt(query.dataset2.getData(1,i))
    ]);
}

var data = google.visualization.arrayToDataTable(rawData);

var options = {
    title: '全站流量统计图',
    hAxis: {title: "日期 =======>",  titleTextStyle: {color: '#333'}},
    vAxis: {title: "数量 =======>",  titleTextStyle: {color: '#333'},minValue: 0},
    curveType: 'function',
    explorer: { 
        actions: ['dragToZoom', 'rightClickToReset'],
        axis: 'horizontal',
        keepInBounds: true,
        maxZoomIn: 4.0
    }
};

var root = ee.getControl("panel21");
var chart;
switch (g5.chart1Mode) {
    case 0: chart = new google.visualization.AreaChart(root); break;
    case 1: chart = new google.visualization.LineChart(root); break;
    case 2: chart = new google.visualization.ColumnChart(root); break;
    default: chart = new google.visualization.AreaChart(root); break;
}

chart.draw(data, options);
]]></functionCode>
    </item>
    <item name="drawCharts2" type="20">
      <varValue />
      <functionParam />
      <functionCode><![CDATA[var rawData = new Array();
rawData.push(
    ["日期", "总浏览数量"]
);

for (var i = 0; i<query.dataset1.rowCount; i++) {
    var s = query.dataset3.getData(0,i);
    s = s.split("-");
    if (s.length!=3) continue;
    rawData.push([
        new Date(parseInt(s[0]),parseInt(s[1])-1,parseInt(s[2])),
        parseInt(query.dataset3.getData(1,i))
    ]);
}

var data = google.visualization.arrayToDataTable(rawData);

var options = {
    title: '全站流量统计图(浏览数量)',
    hAxis: {title: "日期 =======>",  titleTextStyle: {color: '#333'}},
    vAxis: {title: "数量 =======>",  titleTextStyle: {color: '#333'},minValue: 0},
    curveType: 'function',
    explorer: { 
        actions: ['dragToZoom', 'rightClickToReset'],
        axis: 'horizontal',
        keepInBounds: true,
        maxZoomIn: 4.0
    },
    series: {
        0: { color: "#40Af40" },  // 第一条线的颜色
    }
};

var root = ee.getControl("panel11");
var chart;
switch (g5.chart2Mode) {
    case 0: chart = new google.visualization.AreaChart(root); break;
    case 1: chart = new google.visualization.LineChart(root); break;
    case 2: chart = new google.visualization.ColumnChart(root); break;
    default: chart = new google.visualization.AreaChart(root); break;
}

chart.draw(data, options);
]]></functionCode>
    </item>
    <item name="altCharts1" type="20">
      <varValue />
      <functionParam />
      <functionCode>if (g5.chart1Mode == null) g5.chart1Mode = 0;
g5.chart1Mode = (g5.chart1Mode + 1) % 3;
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(g5.drawCharts1);

</functionCode>
    </item>
    <item name="altCharts2" type="20">
      <varValue />
      <functionParam />
      <functionCode>if (g5.chart2Mode == null) g5.chart2Mode = 0;
g5.chart2Mode = (g5.chart2Mode + 1) % 3;
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(g5.drawCharts2);

</functionCode>
    </item>
  </g5Items>
</page>